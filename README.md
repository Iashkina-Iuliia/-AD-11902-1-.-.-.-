# **Кейс «Прогнозирование размеров сварного шва при электронно-лучевой сварке тонкостенных конструкций аэрокосмического назначения»**

## Постановка задачи
В качестве исходных данных были взяты результаты экспериментальных исследований, проводимых в целях улучшения технологического процесса электронно-лучевой сварки изделия, сборка которого состоит из элементов, состоящих из разнородного материала. Установка электронно-лучевой сварки, на которой проводились исследования, предназначена для сварки электронным лучом в глубоком вакууме деталей сборочных единиц из нержавеющих сталей, титановых, алюминиевых и специальных сплавов. Существующая установка электронно-лучевой сварки обеспечивает повторяемость режимов в рамках возможностей реализованной системы управления. Работы по сварке выполнялись на образцах-имитаторах, соответствующих технологическому изделию. Для уменьшения вложения энергии при сварке:
1.	Снижалась величина сварочного тока (IW);
2.	Увеличивался ток фокусировки электронного пучка (IF);
3.	Увеличивалась скорость сварки (VW);
4.	Менялось расстояние от поверхности образцов до электронно-оптической системы (FP). 

По совокупности параметров технологических режимов обеспечивались минимально возможные размеры сварных швов: глубина шва (Depth) и ширина шва (Width).
В процессе выполнения работ была произведена электронно-лучевая сварка 18-ти единиц образцов. Результаты металлографического контроля по размерам сварного шва для каждого образца проводились в 4-х поперечных сечениях сварного шва. Ускоряющее напряжение было постоянным в диапазоне 19,8 – 20 кВ. Набор полученных данных собраны в составе режимов сварки, размеров сварочных швов в поперечных сечениях всех образцов.

Требовалось провести прогнозирование глубины (Depth) и ширины (Width) сварного шва в зависимости от параметров технологического процесса (IW, IF, VW, FP).

## Предварительная обработка датасета
### см. файл "Preprocessing and models.ipynb" в папке Code
В рамках предварительной обработки датасета был загружен файл с исходными данными <ebw_data.xlsx> и проведён его анализ, а именно было выполнено:
 - определение размера датасета: 72 строки, 6 колонок;
 - определение количества пропущенных значений: пропущенные значения отсутствуют;
 - определение количества уникальных значений: LabelEncoder или OneHotEncoder не применимы;
 - построение боксплотов для выявление аномалий/выбросов;
 - выведение описательной статистики датасета;
 - построение "тепловой" карты для наглядного отображения имеющихся зависимостей;
 - стандартизация данных.
 
 ## Применение алгоритмов машинного обучения
 ### см. файл "Preprocessing and models.ipynb" в папке Code
В рамках данного раздела выборка была поделена на обучающую и тестовую, при этом глубина шва (Depth) и ширина шва (Width) считались для моделей отдельно, чтобы избежать ситуации, что какая-то из моделей для одного параметра даст отличный результат, для второго - плохой, а в среднем будет считаться, что результат хороший. 

В качестве моделей машинного обучения были выбраны Ridge, RandomForestRegressor, GradientBoostingRegressor и MLPRegressor. 

Попытка подобрать лучшие параметры с помощью GridSearchCV провалилась, так как мой ноутбук оказался не в восторге от такой ресурсоёмкой задачи.

В целях демонстрации понимания работы GridSearchCV приложен отдельный файл (см. файл <Ridge (GridSearch).ipynb>) с подбором лучших параметров для метода Ridge.

В качестве показателя оценки качества машинного обучения применяется коэффициент детерминации R2.

По итогам анализа результатов было принято решение о применении в приложении метода RandomForestRegressor с параметрами по умолчанию.

## Реализация приложения
### см. файл "APP.ipynb" в папке APP
Учитывая определённые сложности в создании flask-приложения, подробное обсуждение которых велось в Telegram-чате группы, было принято решение о создании оконного приложения с использованием библиотеки tkinter.

Т.к. курсом изучение данной библиотеки не предусмотрено, пришлось разбираться самостоятельно, поэтому возможны ошибки. 

Реализация приложения выглядит следующим образом:
![Снимок](https://user-images.githubusercontent.com/116570890/202692550-3d42e926-92bc-46bb-999e-4784317bd960.png)
